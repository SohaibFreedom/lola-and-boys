{{ 'custom-announce-css.css' | asset_url | stylesheet_tag }}
<div class="annoucment-bar-top">
  {% if section.settings.show_announcement_bar %}
    {% if section.settings.text %}
      <a href="{{ section.settings.Annouce_url }}">
        <div class="announcement-bar" style="background-color: {{ section.settings.bck_clr }};">
          <div class="announcement-bar-text" style="color: {{ section.settings.txt_clr }};">
            <span id="close_announcement_bar" style="display:none;">X</span>
            {% if section.settings.show_countdown %}<div class="countdown"></div>{% endif %}
            <div class="shop-now-text">
              {{ section.settings.text }}
              <p class="details">SHOP NOW</p>
            </div>
          </div>
        </div>
      </a>
      {% if section.settings.show_countdown %}
        <script>
          // Function to format numbers with leading zeros
          const formatWithZero = (num) => `${num}`.padStart(2, '0');

          // Delay initialization of countdown by 2 seconds
          setTimeout(function() {
            // Retrieve the fixed target end date from Liquid variable
            const fixedTargetDate = new Date('{{ section.settings.countdown_end_date }}').getTime();

            // Update the countdown every second
            const countdownTimer = setInterval(function () {
              // Calculate the remaining time in seconds
              const remainingTime = Math.floor((fixedTargetDate - new Date().getTime()) / 1000);

              // Calculate the remaining time in hours, minutes, and seconds
              const hours = Math.floor(remainingTime / 3600);
              const minutes = Math.floor((remainingTime % 3600) / 60);
              const seconds = remainingTime % 60;

              // Format hours, minutes, and seconds with leading zeros
              const formattedHours = formatWithZero(hours);
              const formattedMinutes = formatWithZero(minutes);
              const formattedSeconds = formatWithZero(seconds);

              // Display the remaining time
              const countdownElement = document.querySelector('.countdown');

              countdownElement.innerHTML = `
                <div class="countdown-wrapper">
                  <div class="countdown-number">
                    <div class="hours-number">${formattedHours} <br> <p>Hrs</p></div>
                    <div class="hours-number">${formattedMinutes} <br> <p>Min</p></div>
                    <div class="hours-number">${formattedSeconds} <br> <p>Sec</p></div>
                  </div>
                </div>`;

              // Stop the countdown if the remaining time reaches zero
              if (remainingTime <= 0) {
                clearInterval(countdownTimer);
                countdownElement.textContent = "Countdown is over!";
              }
            }, 100);
          }, 2000); // 2000 milliseconds = 2 seconds
        </script>
      {% endif %}
   
    {% endif %}
  {% endif %}
</div>
